<!DOCTYPE html>
<html>

<body style="background:#262626;">

<img id="card0" width="128px" onclick="clickCard(0)">
<img id="card1" width="128px" onclick="clickCard(1)">
<img id="card2" width="128px" onclick="clickCard(2)">
<img id="card3" width="128px" onclick="clickCard(3)">
<img id="card4" width="128px" onclick="clickCard(4)">
<img id="card5" width="128px" onclick="clickCard(5)">


<img id="card-extra" width="128px" style="padding-left: 12px; border-left: white 1px solid; margin-left: 12px;">
<div id="value" style="color:white">
  Fifteen: <span id="score-fifteen">0</span><br>
  Pair: <span id="score-pair">0</span><br>
  Royal Pair: <span id="score-royal">0</span><br>
  Double Royal Pair: <span id="score-double">0</span><br>
  Run: <span id="score-run">0</span><br>
  Flush: <span id="score-flush">0</span><br>
</div>


<button onclick="discardCards()" id="discard-button" style="display:none;">Discard</button>
</body>

<script>
function Card(suit, rank) {
  this.rank = rank;
  this.suit = suit;
}

var cardHand = [];

// Fifteen, Pair, Royal, Double, Run, Flush
var scores = [0,0,0,0,0,0];

var deck = [
    "spades_A", "spades_K", "spades_Q", "spades_J", "spades_10",
    "spades_9", "spades_8", "spades_7", "spades_6", "spades_5",
    "spades_4", "spades_3", "spades_2",

    "hearts_A", "hearts_K", "hearts_Q", "hearts_J", "hearts_10",
    "hearts_9", "hearts_8", "hearts_7", "hearts_6", "hearts_5",
    "hearts_4", "hearts_3", "hearts_2",

    "diamonds_A", "diamonds_K", "diamonds_Q", "diamonds_J", "diamonds_10",
    "diamonds_9", "diamonds_8", "diamonds_7", "diamonds_6", "diamonds_5",
    "diamonds_4", "diamonds_3", "diamonds_2",

    "clubs_A", "clubs_K", "clubs_Q", "clubs_J", "clubs_10",
    "clubs_9", "clubs_8", "clubs_7", "clubs_6", "clubs_5",
    "clubs_4", "clubs_3", "clubs_2"
];

function shuffleDeck(val) {
  let array = val.slice();
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1)); 
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

deck = shuffleDeck(deck);

//alert(deck[0]);
var i;
for (i=0; i<6; i++) {  
  document.getElementById("card" + i).src="https://raw.githubusercontent.com/hanhaechi/playing-cards/refs/heads/master/" + deck[i] + ".png";
}

var selectedCards = [];

var play = false;

function clickCard(val) {

    var cardSrc = document.getElementById("card" + val).src;
    cardSrc = cardSrc.slice(0, -4); 
    var value = getStringAfterLastChar(cardSrc, "_");
    
  if (!play) {

    //alert(value);
    
    if (selectedCards.indexOf(val) >= 0) {
      document.getElementById("card" + val).style.opacity = "1";
      selectedCards.splice(selectedCards.indexOf(val), 1);
    } else {
      document.getElementById("card" + val).style.opacity = "0.5";
      selectedCards.push(val);
    }
    
  
    if (selectedCards.length == 2) {
      document.getElementById("discard-button").style.display = "block";
    } else {
      document.getElementById("discard-button").style.display = "none";
    }
    
  } else {
    if (value == "J" || value == "Q" || value == "K") {
      value = 10;
    } else if (value == "A") {
      value = 1;
    }
    document.getElementById("value").innerHTML = value;
  }
}

var hand = [];

function discardCards() {
  var tmpHand;
  var j;
  for (j=0;j<6;j++) {
    if(j == selectedCards[0] || j == selectedCards[1]) {
      
    } else {
      tmpHand = document.getElementById("card" + j).src.slice(0, -4); 
      hand.push(tmpHand.substring(tmpHand.lastIndexOf('/')+1));
    }
    
  }
  
  document.getElementById("card" + selectedCards[0]).src = "";
  document.getElementById("card" + selectedCards[1]).src = "";
  
  document.getElementById("card-extra").src = src="https://raw.githubusercontent.com/hanhaechi/playing-cards/refs/heads/master/" + deck[6] + ".png";;
  
  tmpHand = document.getElementById("card-extra").src.slice(0, -4); 
  hand.push(tmpHand.substring(tmpHand.lastIndexOf('/')+1));
  
  play = true;
  document.getElementById("discard-button").style = "display: none;";  
  
  const card0 = new Card(hand[0].substring(0, hand[0].length-2), hand[0].substring(hand[0].length-1,hand[0].length));
  const card1 = new Card(hand[1].substring(0, hand[1].length-2), hand[1].substring(hand[1].length-1,hand[1].length));
  const card2 = new Card(hand[2].substring(0, hand[2].length-2), hand[2].substring(hand[2].length-1,hand[2].length));
  const card3 = new Card(hand[3].substring(0, hand[3].length-2), hand[3].substring(hand[3].length-1,hand[3].length));
  const card4 = new Card(hand[4].substring(0, hand[4].length-2), hand[4].substring(hand[4].length-1,hand[4].length));
  
  cardHand.push(card0);
  cardHand.push(card1);
  cardHand.push(card2);
  cardHand.push(card3);
  cardHand.push(card4);
  
  score();
  //alert(cardHand);
}



function score() {
  document.getElementById("score-pair").innerHTML = scorePairs(cardHand);
  
  document.getElementById("score-flush").innerHTML = scoreFlush(cardHand);
  document.getElementById("score-fifteen").innerHTML = scoreFifteens(cardHand);
  //pairs

}

function getStringAfterLastChar(originalString, character) {
  const lastIndex = originalString.lastIndexOf(character);
  if (lastIndex === -1) {
    return originalString; 
  }
  return originalString.slice(lastIndex + 1);
}

function scorePairs(cards) {
  let score = 0;
  for (let i = 0; i < cardHand.length; i++) {
    for (let j = i + 1; j < cardHand.length; j++) {
      if (cardHand[i].rank === cardHand[j].rank) score += 2;
    }
  }
  return score;
}

function scoreRoyalPairs(cards) {
  let score = 0;
  for (let i = 0; i < cardHand.length; i++) {
    for (let j = i + 1; j < cardHand.length; j++) {
      if (cardHand[i].rank === cardHand[j].rank) score += 2;
    }
  }
  return score;
}

//  Fifteens
function scoreFifteens(cards) {
  let tempValues = [];
  for(let i = 0; i < cardHand.length; i++) {
    if (cardHand[i].rank == "J" || cardHand[i].rank == "Q" || cardHand[i].rank == "K" || cardHand[i].rank == 10 ) {
      tempValues.push(10);
    } else {
      tempValues.push(cardHand[i].rank);
    }
  }

  alert(tempValues);
  let combos = getAllCombos(tempValues);
  let score = combos.filter(sum => sum === 15).length * 2;
  return score;
}

//Flush 
function scoreFlush(cards) {
  var suitsCount = [0,0,0,0];
  var i;
  for (i=0;i<cards.length;i++) {
    if (cards[i].suit == "spades") {
      suitsCount[0]++;
    } else if (cards[i].suit == "clubs") {
      suitsCount[1]++;
    } else if (cards[i].suit == "hearts") {
      suitsCount[2]++;
    } else if (cards[i].suit == "diamonds") {
      suitsCount[3]++;
    }
  }

  if (suitsCount.indexOf(4) >= 0) {
    return 4;
  } else if (suitsCount.indexOf(5) >= 0) {
    return 5;
  } else {
    return 0;
  }
  
  
}

function getAllCombos(values) {
  let sums = [];
  const n = values.length;
  for (let i = 1; i < (1 << n); i++) {
    let sum = 0;
    for (let j = 0; j < n; j++) {
      if (i & (1 << j)) sum += values[j];
    }
    sums.push(sum);
  }
  return sums;
}








</script>

</html>
